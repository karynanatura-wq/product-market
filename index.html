<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Mobile Pink UI</title>

  <style>
    :root{
      --bg: #fde6ee;           /* світло-рожевий фон */
      --cream: #fff2df;        /* кремовий */
      --pinkShadow: rgba(221, 88, 150, 0.45);
      --pinkDark: #d94c8a;     /* темно-рожевий для вибору продукту */
      --logoSelected: #f0d1db; /* темніший для 2-го лого */
      --text: #5a2a3b;
      --radius: 18px;
    }

    *{ box-sizing: border-box; }
    html, body{
      height: 100%;
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      -webkit-tap-highlight-color: transparent;
    }

    /* прибираємо дефолтні стилі кнопок */
    button{
      border: 0;
      background: transparent;
      padding: 0;
      font: inherit;
      color: inherit;
    }

    #app{
      min-height: 100%;
      padding: 16px;
      padding-top: calc(16px + env(safe-area-inset-top));
      padding-bottom: calc(18px + env(safe-area-inset-bottom));
      display: grid;
      place-items: start center;
    }

    .screen{
      width: min(520px, 100%);
      transition: opacity .28s ease, transform .28s ease;
    }
    .hidden{ display: none !important; }

    .fadeOut{
      opacity: 0;
      transform: translateY(-8px);
      pointer-events: none;
    }
    .fadeIn{
      opacity: 1;
      transform: translateY(0);
    }

    .hint{
      text-align: center;
      opacity: .78;
      font-size: 13px;
      margin: 0 0 12px 0;
    }

    /* ---------------- ЕКРАН 1 ---------------- */
    .logoList{
      display: grid;
      gap: 14px;
      width: 100%;
    }

    .logoCard{
      height: clamp(72px, 12vh, 92px);
      border-radius: 16px;
      background: var(--cream);
      box-shadow: 0 10px 24px var(--pinkShadow);
      border: 1px solid rgba(221, 88, 150, 0.25);
      display: grid;
      place-items: center;
      padding: 10px;
      user-select: none;
      cursor: pointer;
      overflow: hidden; /* важливо */
      transition: transform .12s ease, background .18s ease, box-shadow .18s ease;
    }
    .logoCard:active{ transform: scale(0.985); }

    .logoCard .imgWrap{
      width: 100%;
      height: 100%;
      display: grid;
      place-items: center; /* центрування */
    }
    .logoCard img{
      height: 55px;
    }
   .logoCard .biggerImg{
     height: 120px;
     margin-top: -25px;
   }

    .logoCard.selected{
      background: var(--logoSelected);
      box-shadow: 0 12px 28px rgba(221, 88, 150, 0.55);
    }

    /* ---------------- ЕКРАН 2 ---------------- */
    .productsWrap{
      width: 100%;
      display: grid;
      gap: 16px;
      align-items: start;
    }

    .grid{
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      width: 100%;
    }

    .productCard{
      height: clamp(125px, 20vh, 180px);
      border-radius: var(--radius);
      background: rgba(255, 242, 223, 0.92);
      border: 1px solid rgba(221, 88, 150, 0.25);
      box-shadow: 0 12px 26px rgba(221, 88, 150, 0.18);
      display: grid;
      place-items: center;
      padding: 12px;
      cursor: pointer;
      user-select: none;
      position: relative;
      overflow: hidden; /* важливо */
      transition: transform .12s ease, background .18s ease, box-shadow .18s ease, opacity .18s ease;
    }
    .productCard:active{ transform: scale(0.985); }

    .productCard .imgWrap{
      height: 115px;
      margin-top: -10px;
    }
    .productCard img{
      max-width: 100%;
      max-height: 100%;
      width: 100%;
      height: 100%;
      object-fit: contain; /* НЕ виходить за межі */
      display: block;
      filter: drop-shadow(0 8px 12px rgba(0,0,0,0.08));
    }

    .productCard.selected{
      background: var(--pinkDark);
      box-shadow: 0 16px 34px rgba(217, 76, 138, 0.35);
    }

    .productCard.removed{
      opacity: 0;
      pointer-events: none;
    }

    .boxArea{
      width: 100%;
      display: grid;
      place-items: center;
      padding-top: 2px;
    }

    #boxBtn{
      width: clamp(78px, 22vw, 120px);
      height: auto;
      cursor: pointer;
      user-select: none;
      transition: transform .12s ease, filter .18s ease;
      filter: drop-shadow(0 14px 20px rgba(221, 88, 150, 0.22));
    }
    #boxBtn:active{ transform: scale(0.97); }

    /* ---------------- Політ у коробку ---------------- */
    .flyClone{
      position: fixed;
      z-index: 60;
      pointer-events: none;
      will-change: transform, opacity, filter;
      transform-origin: center center;
      filter: drop-shadow(0 14px 18px rgba(0,0,0,0.12));
    }

    /* ---------------- Блюр + успіх + 3D-обертання ---------------- */
    #successOverlay{
      position: fixed;
      inset: 0;
      z-index: 120;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 18px;
    }
    #successOverlay.show{ display: flex; }

    body.done #app{
      filter: blur(8px);
      transform: scale(1.01);
      transition: filter .25s ease, transform .25s ease;
    }

    #successOverlay::before{
      content: "";
      position: absolute;
      inset: 0;
      background: rgba(253, 230, 238, 0.35);
      backdrop-filter: blur(2px);
    }

    .successIcon{
      position: relative;
      width: clamp(92px, 28vw, 140px);
      height: clamp(92px, 28vw, 140px);
      display: grid;
      place-items: center;
      z-index: 1;
      perspective: 900px; /* для 3D */
    }
    .successIcon img{
      width: 100%;
      height: 100%;
      object-fit: contain;
      transform-style: preserve-3d;
      backface-visibility: hidden;
      animation: spin3d 1.1s linear infinite;
      filter: drop-shadow(0 16px 26px rgba(0,0,0,0.12));
    }
    @keyframes spin3d{
      from{ transform: rotateY(0deg) rotateX(8deg); }
      to{ transform: rotateY(360deg) rotateX(8deg); }
    }

    /* ---------------- Конфеті ---------------- */
    .confetti{
      position: fixed;
      z-index: 140;
      pointer-events: none;
      width: 8px;
      height: 14px;
      border-radius: 3px;
      will-change: transform, opacity;
      opacity: 0.98;
    }

    /* фокус */
    .logoCard:focus-visible,
    .productCard:focus-visible,
    #boxBtn:focus-visible{
      outline: 3px solid rgba(217, 76, 138, 0.45);
      outline-offset: 3px;
    }
  </style>
</head>

<body>
  <main id="app">
    <!-- ЕКРАН 1 -->
    <section id="screen1" class="screen fadeIn" aria-label="Вибір логотипу">

      <div class="logoList">
        <button class="logoCard" type="button" data-logo="3" aria-label="logo (3)">
          <div class="imgWrap"><img src="logo%20(3).png" alt="logo (3)" /></div>
        </button>

        <button id="logo1Btn" class="logoCard" type="button" data-logo="1" aria-label="logo (1)">
          <div class="imgWrap"><img class="biggerImg" src="logo%20(1).png" alt="logo (1)" /></div>
        </button>

        <button class="logoCard" type="button" data-logo="4" aria-label="logo (4)">
          <div class="imgWrap"><img class="biggerImg" src="logo%20(4).png" alt="logo (4)" /></div>
        </button>

        <button class="logoCard" type="button" data-logo="2" aria-label="logo (2)">
          <div class="imgWrap"><img class="biggerImg" src="logo%20(2).png" alt="logo (2)" /></div>
        </button>
      </div>
    </section>

    <!-- ЕКРАН 2 -->
    <section id="screen2" class="screen hidden" aria-label="Вибір продуктів">
      <div class="productsWrap">
        <div class="grid" id="productsGrid">
          <button class="productCard" type="button" data-product="3" aria-label="product (3)">
            <div class="imgWrap"><img src="product%20(3).png" alt="product (3)" /></div>
          </button>
          <button class="productCard" type="button" data-product="4" aria-label="product (4)">
            <div class="imgWrap"><img src="product%20(4).png" alt="product (4)" /></div>
          </button>
          <button class="productCard" type="button" data-product="5" aria-label="product (5)">
            <div class="imgWrap"><img src="product%20(5).png" alt="product (5)" /></div>
          </button>
          <button class="productCard" type="button" data-product="2" aria-label="product (2)">
            <div class="imgWrap"><img src="product%20(2).png" alt="product (2)" /></div>
          </button>
          <button class="productCard" type="button" data-product="1" aria-label="product (1)">
            <div class="imgWrap"><img src="product%20(1).png" alt="product (1)" /></div>
          </button>
          <button class="productCard" type="button" data-product="6" aria-label="product (6)">
            <div class="imgWrap"><img src="product%20(6).png" alt="product (6)" /></div>
          </button>
        </div>

        <div class="boxArea">
          <img id="boxBtn" src="box.png" alt="box" role="button" tabindex="0" />
        </div>
      </div>
    </section>
  </main>

  <!-- Оверлей успіху -->
  <div id="successOverlay" aria-hidden="true">
    <div class="successIcon" aria-label="Успіх">
      <img id="galkaImg" src="galka.png" alt="Галочка" />
    </div>
  </div>

  <script>
    const screen1 = document.getElementById('screen1');
    const screen2 = document.getElementById('screen2');
    const logo1Btn = document.getElementById('logo1Btn');
    const productsGrid = document.getElementById('productsGrid');
    const boxBtn = document.getElementById('boxBtn');
    const successOverlay = document.getElementById('successOverlay');
    const galkaImg = document.getElementById('galkaImg');

    let animating = false;

    // 1) Натиснули на logo (1) -> темніше + перехід
    logo1Btn.addEventListener('click', () => {
      if (animating) return;
      logo1Btn.classList.add('selected');
      setTimeout(() => transitionToScreen2(), 220);
    });

    function transitionToScreen2(){
      animating = true;
      screen1.classList.add('fadeOut');
      setTimeout(() => {
        screen1.classList.add('hidden');
        screen2.classList.remove('hidden');
        screen2.classList.add('fadeIn');
        animating = false;
      }, 260);
    }

    // 2) Вибір продуктів
    productsGrid.addEventListener('click', (e) => {
      const card = e.target.closest('.productCard');
      if (!card || animating || card.classList.contains('removed')) return;
      card.classList.toggle('selected');
    });

    // 3) Клік по box -> політ (1 сек, плавно і помітно)
    boxBtn.addEventListener('click', () => runBoxAnimation());
    boxBtn.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        runBoxAnimation();
      }
    });

    async function runBoxAnimation(){
      if (animating) return;

      const selectedCards = [...document.querySelectorAll('.productCard.selected:not(.removed)')];

      if (selectedCards.length === 0) {
        boxBtn.animate(
          [{ transform: 'translateY(0) scale(1)' }, { transform: 'translateY(-3px) scale(1.03)' }, { transform: 'translateY(0) scale(1)' }],
          { duration: 300, easing: 'ease-out' }
        );
        return;
      }

      animating = true;

      const boxRect = boxBtn.getBoundingClientRect();
      const boxCenterX = boxRect.left + boxRect.width / 2;
      const boxCenterY = boxRect.top + boxRect.height / 2;

      // запускаємо польоти паралельно
      const flights = selectedCards.map((card, i) => flyCardToBox(card, boxCenterX, boxCenterY, i));
      await Promise.all(flights);

      // блюр + галка + конфеті
      document.body.classList.add('done');
      successOverlay.classList.add('show');
      successOverlay.setAttribute('aria-hidden', 'false');

      launchConfettiFromGalka();

      // конфеті падає ще 2 секунди: блокуємо взаємодію на цей час
      setTimeout(() => { animating = false; }, 2300);
    }

    function flyCardToBox(card, boxCenterX, boxCenterY, index){
      return new Promise((resolve) => {
        const img = card.querySelector('img');
        const rect = img.getBoundingClientRect();

        // клон картинки, щоб було плавно й незалежно від grid
        const clone = img.cloneNode(true);
        clone.classList.add('flyClone');

        // робимо стартовий клон трохи більшим для “помітності”
        const startW = rect.width * 1.05;
        const startH = rect.height * 1.05;

        clone.style.left = (rect.left - (startW - rect.width)/2) + 'px';
        clone.style.top  = (rect.top  - (startH - rect.height)/2) + 'px';
        clone.style.width  = startW + 'px';
        clone.style.height = startH + 'px';
        clone.style.objectFit = 'contain';

        document.body.appendChild(clone);

        const startX = rect.left + rect.width / 2;
        const startY = rect.top + rect.height / 2;

        const dx = boxCenterX - startX;
        const dy = boxCenterY - startY;

        // “дуга”: середня точка трохи вище, щоб було видно політ
        const midX = dx * 0.55;
        const midY = dy * 0.45 - 90; // підйом

        const delay = index * 40;     // легка “хвиля”
        const duration = 1000;        // 1 сек, як просили

        const anim = clone.animate(
          [
            { transform: 'translate(0px, 0px) scale(1) rotate(0deg)', opacity: 1 },
            { transform: `translate(${midX}px, ${midY}px) scale(1.08) rotate(8deg)`, opacity: 1, offset: 0.45 },
            { transform: `translate(${dx}px, ${dy}px) scale(0.35) rotate(-6deg)`, opacity: 0.05 }
          ],
          {
            delay,
            duration,
            easing: 'cubic-bezier(0.22, 1, 0.36, 1)',
            fill: 'forwards'
          }
        );

        anim.onfinish = () => {
          clone.remove();

          // “зникнути” після прильоту
          card.classList.remove('selected');
          card.classList.add('removed');

          // щоб не було “дірки” миттєво — можна лишити місце, але невидиме
          // Якщо хочете повністю прибрати з розкладки: card.style.display = 'none';
          card.style.visibility = 'hidden';

          resolve();
        };
      });
    }

    // -------- Конфеті зліва і справа від галочки, падіння 2 секунди --------
    function launchConfettiFromGalka(){
      const rect = galkaImg.getBoundingClientRect();

      const leftX  = rect.left + rect.width * 0.18;
      const rightX = rect.left + rect.width * 0.82;
      const y0 = rect.top + rect.height * 0.55;

      const colors = [
        '#ff4d6d','#ff8fab','#f72585','#b5179e',
        '#7209b7','#4cc9f0','#ffd166','#06d6a0',
        '#fca311','#fb5607'
      ];

      const piecesPerSide = 26; // можна збільшити/зменшити

      for (let i = 0; i < piecesPerSide; i++){
        spawnConfettiPiece(leftX, y0, -1, colors);
        spawnConfettiPiece(rightX, y0,  1, colors);
      }
    }

    function spawnConfettiPiece(xStart, yStart, sideDir, colors){
      const el = document.createElement('div');
      el.className = 'confetti';

      // рандомний розмір
      const w = rand(6, 10);
      const h = rand(10, 18);
      el.style.width = w + 'px';
      el.style.height = h + 'px';

      el.style.left = xStart + 'px';
      el.style.top  = yStart + 'px';

      el.style.background = colors[Math.floor(Math.random() * colors.length)];

      document.body.appendChild(el);

      // “виліт” вбік + падіння
      const burstX = sideDir * rand(80, 150);
      const burstY = rand(-30, 40);

      const driftX = sideDir * rand(20, 60) + rand(-20, 20);
      const fallY = window.innerHeight - yStart + rand(120, 220);

      const rot1 = rand(-180, 180);
      const rot2 = rot1 + sideDir * rand(540, 900);

      el.animate(
        [
          { transform: `translate(0px, 0px) rotate(${rot1}deg)`, opacity: 1 },
          { transform: `translate(${burstX}px, ${burstY}px) rotate(${rot1 + sideDir*120}deg)`, opacity: 1, offset: 0.18 },
          { transform: `translate(${burstX + driftX}px, ${fallY}px) rotate(${rot2}deg)`, opacity: 0.95 }
        ],
        {
          duration: 2300, // 0.3s burst + ~2s падіння
          easing: 'cubic-bezier(0.2, 0.8, 0.2, 1)',
          fill: 'forwards'
        }
      ).onfinish = () => el.remove();
    }

    function rand(min, max){
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }
  </script>

  <!--
    Файли зображень у тій самій папці:
      logo (1).png, logo (2).png, logo (3).png, logo (4).png
      product (1).png ... product (6).png
      box.png
      galka.png
  -->
</body>
</html>
